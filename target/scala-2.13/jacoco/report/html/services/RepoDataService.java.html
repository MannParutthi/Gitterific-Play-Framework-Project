<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>RepoDataService.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=2;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Jacoco Coverage Report</a> &gt; <a href="index.source.html" class="el_package">services</a> &gt; <span class="el_source">RepoDataService.java</span></div><h1>RepoDataService.java</h1><pre class="source lang-java linenums">package services;

import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.CompletionStage;
import java.util.stream.Collectors;

import org.eclipse.egit.github.core.Contributor;
import org.eclipse.egit.github.core.Issue;
import org.eclipse.egit.github.core.Repository;
import org.eclipse.egit.github.core.RepositoryCommit;
import org.eclipse.egit.github.core.client.GitHubClient;
import org.eclipse.egit.github.core.service.CommitService;
import org.eclipse.egit.github.core.service.IssueService;
import org.eclipse.egit.github.core.service.RepositoryService;

import model.RepoCommitModel;
import model.RepoContributorModel;
import model.RepoDataModel;
import model.RepoIssueModel;
import play.mvc.Http.Session;


public class RepoDataService {
	
	private RepositoryService repositoryService;
	private IssueService issueService;
	private CommitService commitService;
	private GitHubClient gitHubClient;
	
<span class="fc" id="L33">	public RepoDataService() {</span>
<span class="fc" id="L34">		gitHubClient = new GitHubClient();</span>
<span class="fc" id="L35">		this.repositoryService = new RepositoryService(gitHubClient);</span>
<span class="fc" id="L36">		this.issueService = new IssueService(gitHubClient);</span>
<span class="fc" id="L37">		this.commitService = new CommitService(gitHubClient);</span>
<span class="fc" id="L38">	}</span>
	
	public CompletionStage&lt;List&lt;RepoDataModel&gt;&gt; getRepoData(String userName) {
<span class="nc" id="L41">		return CompletableFuture.supplyAsync(() -&gt; {		</span>
<span class="nc" id="L42">			List&lt;RepoDataModel&gt; repoData = new ArrayList&lt;RepoDataModel&gt;();</span>
			try {
<span class="nc" id="L44">				List&lt;Repository&gt; repoList = repositoryService.getRepositories(userName);	</span>
<span class="nc bnc" id="L45" title="All 2 branches missed.">				for (Repository repository : repoList) {</span>
<span class="nc" id="L46">					RepoDataModel repoDetails = new RepoDataModel();</span>
<span class="nc" id="L47">					repoDetails.setName(repository.getName());</span>
<span class="nc" id="L48">					repoDetails.setId(repository.getId());</span>
<span class="nc" id="L49">					repoDetails.setDescription(repository.getDescription());</span>
<span class="nc" id="L50">					repoDetails.setLanguage(repository.getLanguage());</span>
<span class="nc" id="L51">					repoDetails.setUrl(repository.getHtmlUrl());</span>
<span class="nc" id="L52">					repoDetails.setCloneUrl(repository.getCloneUrl());</span>
<span class="nc" id="L53">					repoDetails.setCreatedOn(repository.getCreatedAt());</span>
<span class="nc" id="L54">					repoDetails.setLastUpdatedOn(repository.getUpdatedAt());</span>
					
<span class="nc" id="L56">					List&lt;RepoContributorModel&gt; repoContributorList = new ArrayList&lt;RepoContributorModel&gt;();</span>
<span class="nc" id="L57">					List&lt;Contributor&gt; contributorList = repositoryService.getContributors(repository, false);</span>
<span class="nc bnc" id="L58" title="All 2 branches missed.">					for (Contributor contributor : contributorList) {</span>
<span class="nc" id="L59">						RepoContributorModel repoContributorDetails = new RepoContributorModel();</span>
<span class="nc" id="L60">						repoContributorDetails.setLoginName(contributor.getLogin());</span>
<span class="nc" id="L61">						repoContributorDetails.setUrl(contributor.getUrl());</span>
<span class="nc" id="L62">						repoContributorList.add(repoContributorDetails);</span>
<span class="nc" id="L63">					}</span>
<span class="nc" id="L64">					repoDetails.setContributors(repoContributorList);</span>
					
<span class="nc" id="L66">					List&lt;RepoIssueModel&gt; repoIssueList = new ArrayList&lt;RepoIssueModel&gt;();</span>
<span class="nc" id="L67">					List&lt;Issue&gt; issueList = issueService.getIssues(repository, null).stream().limit(20).collect(Collectors.toList());</span>
<span class="nc bnc" id="L68" title="All 2 branches missed.">					for (Issue issue : issueList) {</span>
<span class="nc" id="L69">						RepoIssueModel repoIssueDetails = new RepoIssueModel();</span>
<span class="nc" id="L70">						repoIssueDetails.setTitle(issue.getTitle());</span>
<span class="nc" id="L71">						repoIssueDetails.setUrl(issue.getUrl());</span>
<span class="nc" id="L72">						repoIssueList.add(repoIssueDetails);</span>
<span class="nc" id="L73">					}</span>
<span class="nc" id="L74">					repoDetails.setIssues(repoIssueList);</span>
					
<span class="nc" id="L76">					List&lt;RepoCommitModel&gt; repoCommitList = new ArrayList&lt;RepoCommitModel&gt;();</span>
<span class="nc" id="L77">					List&lt;RepositoryCommit&gt; commitList = commitService.getCommits(repository);</span>
<span class="nc bnc" id="L78" title="All 2 branches missed.">					for (RepositoryCommit commit : commitList) {</span>
<span class="nc" id="L79">						RepoCommitModel repoCommitDetails = new RepoCommitModel();</span>
<span class="nc" id="L80">						repoCommitDetails.setLoginName(commit.getAuthor().getLogin());</span>
<span class="nc" id="L81">						repoCommitDetails.setUrl(commit.getUrl());</span>
<span class="nc" id="L82">						repoCommitList.add(repoCommitDetails);</span>
<span class="nc" id="L83">					}</span>
<span class="nc" id="L84">					repoDetails.setCommits(repoCommitList);</span>
					
<span class="nc" id="L86">					repoData.add(repoDetails);</span>
<span class="nc" id="L87">				} </span>
				
				
<span class="nc" id="L90">			} catch (IOException e) {</span>
				// TODO Auto-generated catch block
<span class="nc" id="L92">				e.printStackTrace();</span>
<span class="nc" id="L93">			}</span>
<span class="nc" id="L94">			return repoData;</span>
		});
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>